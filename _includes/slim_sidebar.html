<div id="sidebar">
    <div class="sidebar-button" id="dictionary-button" data-tooltip="Dictionary">
        <span class="icon">üìö</span>
        <span class="label">Dictionary</span>
    </div>
    <div class="sidebar-button" data-tooltip="Navigation">
      <span class="icon">üß≠</span>
      <span class="label">Navigation</span>
    </div>
    <div class="sidebar-separator"></div>
    <div class="sidebar-button" data-tooltip="Voice Input">
      <span class="icon">üé§</span>
      <span class="label">Voice Input</span>
    </div>
    <div class="sidebar-button" data-tooltip="Bookmarks">
      <span class="icon">üîñ</span>
      <span class="label">Bookmarks</span>
    </div>
    <div class="sidebar-button" data-tooltip="Notes">
      <span class="icon">üìù</span>
      <span class="label">Notes</span>
    </div>
    <div class="sidebar-separator"></div>
    <!-- Text to Speech Button -->
    <div class="sidebar-button" id="tts-button" data-tooltip="Read Selected Text">
      <span class="icon">üîä</span>
      <span class="label">Read Text</span>
    </div>
    <div class="sidebar-separator"></div>
    <div class="sidebar-button" data-tooltip="Settings">
      <span class="icon">‚öôÔ∏è</span>
      <span class="label">Settings</span>
    </div>
  </div>
  <!-- Dictionary Modal -->
<div id="dictionary-modal" style="display:none; position:fixed; right:0; top:0; height:100vh; width:320px; background:#fff; border-left:1px solid #ccc; box-shadow:-5px 0 15px rgba(0,0,0,0.1); padding:20px; overflow-y:auto; z-index:1100; font-family:sans-serif;">
    <button id="close-dict" style="float:right; font-size:18px; cursor:pointer; border:none; background:none;">‚úñ</button>
    <h3 style="margin-top:0; margin-bottom:12px;">Dictionary Lookup</h3>
    <input type="text" id="dict-input" placeholder="Enter a word" style="width:100%; padding:8px; font-size:16px; border:1px solid #ccc; border-radius:4px;"/>
    <button id="search-dict" style="margin-top:10px; padding:10px; width:100%; font-size:16px; background:#667eea; border:none; border-radius:6px; color:#fff; cursor:pointer;">Search</button>
    <div id="dict-result" style="margin-top:20px; line-height:1.4; color:#333;"></div>
</div>
  
  <style>
    
    /* Reset and basic styling */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    #sidebar {
      position: fixed;
      top: 50%;
      left: 30px;
      transform: translateY(-50%);
      width: 70px;
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(25px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 24px;
      display: flex;
      flex-direction: column;
      padding: 20px 0;
      gap: 8px;
      z-index: 1000;
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.1),
        0 8px 24px rgba(0, 0, 0, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.9);
      transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: visible;
    }
    #sidebar:hover {
      width: 200px;
      padding: 20px 12px;
    }
    .sidebar-button {
      display: flex;
      align-items: center;
      width: 50px;
      height: 50px;
      margin: 0 auto;
      background: rgba(0, 0, 0, 0.03);
      border: 1px solid rgba(0, 0, 0, 0.06);
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      text-align: center;
    }
    #sidebar:hover .sidebar-button {
      width: 100%;
      gap: 14px;
    }
    .icon {
      font-size: 22px;
      line-height: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 50px;
      height: 50px;
      flex-shrink: 0;
      transition: all 0.3s ease;
      user-select: none;
      position: absolute;
      left: 0;
      top: 0;
    }
    #sidebar:hover .icon {
      position: static;
      width: 22px;
      height: 22px;
      margin-left: 16px;
    }
    .sidebar-button:hover {
      background: linear-gradient(135deg, #667eea, #764ba2);
      border-color: rgba(102, 126, 234, 0.3);
      transform: translateY(-2px);
      box-shadow: 
        0 8px 20px rgba(102, 126, 234, 0.2),
        0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .sidebar-button:hover .icon {
      transform: scale(1.1);
      filter: brightness(1.1) contrast(1.1);
    }
    .sidebar-button:active {
      transform: translateY(0);
      box-shadow: 
        0 4px 12px rgba(102, 126, 234, 0.15),
        0 2px 6px rgba(0, 0, 0, 0.08);
    }
    .label {
      font-size: 14px;
      font-weight: 500;
      color: #2d3748;
      white-space: nowrap;
      opacity: 0;
      transform: translateX(-10px);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      pointer-events: none;
      position: absolute;
      left: 60px;
    }
    #sidebar:hover .label {
      position: static;
      margin-left: 0;
    }
    #sidebar:hover .label {
      opacity: 1;
      transform: translateX(0);
      pointer-events: all;
    }
    .sidebar-button:hover .label {
      color: white;
      font-weight: 600;
    }
    .sidebar-separator {
      width: 60%;
      height: 1px;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(0, 0, 0, 0.08), 
        transparent
      );
      margin: 8px auto;
      transition: all 0.3s ease;
    }
    #sidebar:hover .sidebar-separator {
      width: 80%;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(0, 0, 0, 0.12), 
        transparent
      );
    }
    /* Tooltip for minimized state */
    .sidebar-button::before {
      content: attr(data-tooltip);
      position: absolute;
      left: calc(100% + 15px);
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      pointer-events: none;
      z-index: 1001;
    }
    .sidebar-button::after {
      content: '';
      position: absolute;
      left: calc(100% + 8px);
      top: 50%;
      transform: translateY(-50%);
      border: 6px solid transparent;
      border-right-color: rgba(0, 0, 0, 0.9);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      z-index: 1001;
    }
    #sidebar:not(:hover) .sidebar-button:hover::before,
    #sidebar:not(:hover) .sidebar-button:hover::after {
      opacity: 1;
      visibility: visible;
    }
    /* Hide tooltips when sidebar is expanded */
    #sidebar:hover .sidebar-button::before,
    #sidebar:hover .sidebar-button::after {
      opacity: 0 !important;
      visibility: hidden !important;
    }
  </style>
  
<script>
    document.addEventListener('DOMContentLoaded', () => {
    const ttsButton = document.getElementById('tts-button');

    ttsButton.addEventListener('mousedown', () => {
        const selection = window.getSelection();
        const container = document.getElementById('lesson-content');

        if (!selection || selection.rangeCount === 0) {
        alert('Please select some text in the lesson to read.');
        return;
        }

        if (!container) {
        alert('Lesson content area not found.');
        return;
        }

        let selectedText = '';
        for (let i = 0; i < selection.rangeCount; i++) {
        const range = selection.getRangeAt(i);

        // Check if any part of the selection intersects lesson-content
        const rangeContent = range.cloneContents();
        const tempDiv = document.createElement('div');
        tempDiv.appendChild(rangeContent);

        if (container.contains(range.startContainer) || container.contains(range.endContainer)) {
            selectedText += selection.toString();
            break;
        }
        }

        selectedText = selectedText.trim();

        if (!selectedText) {
        alert('Please select text within the lesson content.');
        return;
        }

        const API_KEY = '56c7e2a8367048b8ae6c5278adb13c46';
        const ttsUrl = `https://api.voicerss.org/?key=${API_KEY}&hl=en-us&src=${encodeURIComponent(selectedText)}&c=MP3&f=44khz_16bit_stereo`;

        let audio = document.getElementById('tts-audio');
        if (!audio) {
        audio = document.createElement('audio');
        audio.id = 'tts-audio';
        document.body.appendChild(audio);
        }
        audio.src = ttsUrl;
        audio.play().catch(err => {
        alert('Failed to play TTS audio: ' + err.message);
        });
    });
    });
    document.addEventListener('DOMContentLoaded', () => {
  const dictionaryButton = document.getElementById('dictionary-button');
  const dictionaryModal = document.getElementById('dictionary-modal');
  const closeDictBtn = document.getElementById('close-dict');
  const searchDictBtn = document.getElementById('search-dict');
  const dictInput = document.getElementById('dict-input');
  const dictResult = document.getElementById('dict-result');

  // Open modal on sidebar button click
  dictionaryButton.addEventListener('click', () => {
    dictionaryModal.style.display = 'block';
    dictInput.focus();
  });

  // Close modal on close button click
  closeDictBtn.addEventListener('click', () => {
    dictionaryModal.style.display = 'none';
    dictInput.value = '';
    dictResult.innerHTML = '';
  });

  // Search dictionary function
  function searchDictionary() {
    const word = dictInput.value.trim();
    if (!word) {
      alert('Please enter a word to look up.');
      return;
    }

    dictResult.innerHTML = '<em>Loading...</em>';

    fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word)}`)
      .then(res => {
        if (!res.ok) throw new Error('Word not found');
        return res.json();
      })
      .then(data => {
        const meanings = data[0].meanings;
        let html = `<h4 style="margin-bottom:10px;">${data[0].word}</h4>`;

        meanings.forEach(meaning => {
          html += `<b style="text-transform: capitalize;">${meaning.partOfSpeech}</b><br/>`;
          meaning.definitions.forEach((def, i) => {
            html += `${i + 1}. ${def.definition}<br/>`;
            if (def.example) html += `<i style="color:#555;">Example: ${def.example}</i><br/>`;
          });
          html += '<br/>';
        });

        dictResult.innerHTML = html;
      })
      .catch(() => {
        dictResult.innerHTML = '<span style="color:red;">No definition found. Try another word.</span>';
      });
  }

  // Search on button click
  searchDictBtn.addEventListener('click', searchDictionary);

  // Also allow Enter key in input to trigger search
  dictInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      e.preventDefault();
      searchDictionary();
    }
  });
});

</script>
  